@hex:
  # 2 prefixes of the same type
  # lock lock add %eax,(%rsp)
  F0 F0 01 04 24
  # mov %edi,%edi
  # lea (%r15,%rdi),%rdi
  # rep rep stos %eax,%es:(%rdi)
  89 FF
  49 8D 3C 3F
  F3 F3 AB
  # mov %edi,%edi
  # lea (%r15,%rdi),%rdi
  # repne rep stos %eax,%es:(%rdi)
  89 FF
  49 8D 3C 3F
  F2 F3 AB
  # mov %edi,%edi
  # lea (%r15,%rdi),%rdi
  # rep repne scas %es:(%rdi),%al
  89 FF
  49 8D 3C 3F
  F3 F2 AE
  # fs gs mov %eax,%eax
  64 65 89 C0
  # 0x66 mov %ax,%ax
  66 66 89 C0
  # 0x67 mov %eax,(%esp)
  67 67 89 04 24
@dis:
     0:	f0 f0 01 04 24                               	lock add %eax,(%rsp)
     5:	89 ff                                        	mov    %edi,%edi
     7:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
     b:	f3 f3 ab                                     	rep stos %eax,%es:(%rdi)
     e:	89 ff                                        	mov    %edi,%edi
    10:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
    14:	f2 f3 ab                                     	rep repnz stos %eax,%es:(%rdi)
    17:	89 ff                                        	mov    %edi,%edi
    19:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
    1d:	f3 f2 ae                                     	repz repnz scas %es:(%rdi),%al
    20:	64                                           	fs
    21:	65                                           	gs
    22:	89 c0                                        	mov    %eax,%eax
    24:	66 66 89 c0                                  	mov    %ax,%ax
    28:	67 67 89 04 24                               	addr32 mov %eax,(%esp)
@rdfa_output:
  0: [0] unrecognized instruction
  b: [1] unrecognized instruction
  14: [2] unrecognized instruction
  1d: [3] unrecognized instruction
  20: [0] unrecognized instruction
  24: [1] unrecognized instruction
  28: [2] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # rex rex jmp $
  40 40 EB FD
@dis:
     0:	40                                           	rex
     1:	40 eb fd                                     	rex jmp    0x1
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # 2 prefixes of different type
  # lock add %eax, %ss:(%rsp)
  36 F0 01 04 24
  F0 36 01 04 24
  
  # mov %edi,%edi
  # lea (%r15,%rdi),%rdi
  # es rep stos %eax,%es:(%rdi)
  89 FF
  49 8D 3C 3F
  26 F3 AB
  89 FF
  49 8D 3C 3F
  F3 26 AB
  
  # nops for bundle alignment
  90 90 90 90
  
  # lock add %ax, (%rsp)
  66 F0 01 04 24
  F0 66 01 04 24
@dis:
     0:	36 f0 01 04 24                               	lock add %eax,%ss:(%rsp)
     5:	f0 36 01 04 24                               	lock add %eax,%ss:(%rsp)
     a:	89 ff                                        	mov    %edi,%edi
     c:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
    10:	26                                           	es
    11:	f3 ab                                        	rep stos %eax,%es:(%rdi)
    13:	89 ff                                        	mov    %edi,%edi
    15:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
    19:	f3                                           	repz
    1a:	26                                           	es
    1b:	ab                                           	stos   %eax,%es:(%rdi)
    1c:	90                                           	nop
    1d:	90                                           	nop
    1e:	90                                           	nop
    1f:	90                                           	nop
    20:	66 f0 01 04 24                               	lock add %ax,(%rsp)
    25:	f0 66 01 04 24                               	lock add %ax,(%rsp)
@rdfa_output:
  0: [0] unrecognized instruction
  5: [1] unrecognized instruction
  10: [2] unrecognized instruction
  19: [3] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # Doesn't validate due to bug.
  # mov %edi,%edi
  # lea (%r15,%rdi),%rdi
  # rep stosw %ax,%es:(%rdi)
  89 FF
  49 8D 3C 3F
  66 F3 AB
  89 FF
  49 8D 3C 3F
  F3 66 AB
@dis:
     0:	89 ff                                        	mov    %edi,%edi
     2:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
     6:	66 f3 ab                                     	rep stos %ax,%es:(%rdi)
     9:	89 ff                                        	mov    %edi,%edi
     b:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
     f:	f3 66 ab                                     	rep stos %ax,%es:(%rdi)
@rdfa_output:
  6: [0] unrecognized instruction
  f: [1] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # lock add %eax, (%esp)
  67 F0 01 04 24
  F0 67 01 04 24
  
  # rep stos %eax, %es:(%edi)
  89 FF
  49 8D 3C 3F
  67 F3 AB
  89 FF
  49 8D 3C 3F
  F3 67 AB
@dis:
     0:	67 f0 01 04 24                               	lock addr32 add %eax,(%esp)
     5:	f0 67 01 04 24                               	lock addr32 add %eax,(%esp)
     a:	89 ff                                        	mov    %edi,%edi
     c:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
    10:	67 f3 ab                                     	rep addr32 stos %eax,%es:(%edi)
    13:	89 ff                                        	mov    %edi,%edi
    15:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
    19:	f3 67 ab                                     	rep addr32 stos %eax,%es:(%edi)
@rdfa_output:
  0: [0] unrecognized instruction
  5: [1] unrecognized instruction
  10: [2] unrecognized instruction
  19: [3] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # lock add %rax, (%rsp)
  f0 48 01 04 24
  48 f0 01 04 24
  # mov %edi,%edi
  # lea (%r15,%rdi),%rdi
  # rep stos %rax,%es:(%rdi)
  89 FF
  49 8D 3C 3F
  F3 48 AB
@dis:
     0:	f0 48 01 04 24                               	lock add %rax,(%rsp)
     5:	48                                           	rex.W
     6:	f0 01 04 24                                  	lock add %eax,(%rsp)
     a:	89 ff                                        	mov    %edi,%edi
     c:	49 8d 3c 3f                                  	lea    (%r15,%rdi,1),%rdi
    10:	f3 48 ab                                     	rep stos %rax,%es:(%rdi)
@rdfa_output:
  5: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # fs mov %ax,%ax
  64 66 89 C0
@dis:
     0:	64                                           	fs
     1:	66 89 c0                                     	mov    %ax,%ax
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # fs mov %ax,%ax
  66 64 89 C0
@dis:
     0:	66                                           	data16
     1:	64                                           	fs
     2:	89 c0                                        	mov    %eax,%eax
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  67 64 01 04 24
@dis:
     0:	67 64 01 04 24                               	addr32 add %eax,%fs:(%esp)
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  64 67 01 04 24
@dis:
     0:	64 67 01 04 24                               	addr32 add %eax,%fs:(%esp)
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  64 48 89 C0
@dis:
     0:	64                                           	fs
     1:	48 89 c0                                     	mov    %rax,%rax
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  48 64 89 C0
@dis:
     0:	48                                           	rex.W
     1:	64                                           	fs
     2:	89 c0                                        	mov    %eax,%eax
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  66 67 01 04 24
@dis:
     0:	66 67 01 04 24                               	addr32 add %ax,(%esp)
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  67 66 01 04 24
@dis:
     0:	67 66 01 04 24                               	addr32 add %ax,(%esp)
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  66 44 89 3C 24
@dis:
     0:	66 44 89 3c 24                               	mov    %r15w,(%rsp)
@rdfa_output:
  return code: 0
----------------------------------------------------------------------
@hex:
  # REX prefix can't go begore legacy prefix
  44 66 89 3C 24
@dis:
     0:	44                                           	rex.R
     1:	66 89 3c 24                                  	mov    %di,(%rsp)
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  67 4C 89 3C 24
@dis:
     0:	67 4c 89 3c 24                               	addr32 mov %r15,(%esp)
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  4C 67 89 3C 24
@dis:
     0:	4c                                           	rex.WR
     1:	67 89 3c 24                                  	addr32 mov %edi,(%esp)
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # 2 prefixes when one is mandatory
  # fs phaddw %xmm0,%xmm1
  64 66 0F 38 01 C8
@dis:
     0:	64                                           	fs
     1:	66 0f 38 01 c8                               	phaddw %xmm0,%xmm1
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # fs addsd %xmm0,%xmm1
  64 F2 0F 58 C8
@dis:
     0:	64                                           	fs
     1:	f2 0f 58 c8                                  	addsd  %xmm0,%xmm1
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # 0x66 phaddw %xmm0,%xmm1
  66 66 0F 38 01 C8
@dis:
     0:	66 66 0f 38 01 c8                            	phaddw %xmm0,%xmm1
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # 0x66 addsd %xmm0,%xmm1
  66 F2 0F 58 C8
@dis:
     0:	66                                           	data16
     1:	f2 0f 58 c8                                  	addsd  %xmm0,%xmm1
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # phaddw (%esp), %xmm0
  67 66 0f 38 01 04 24
@dis:
     0:	67 66 0f 38 01 04 24                         	addr32 phaddw (%esp),%xmm0
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  # addsd (%esp), %xmm0
  67 f2 0f 58 04 24
@dis:
     0:	67 f2 0f 58 04 24                            	addr32 addsd (%esp),%xmm0
@rdfa_output:
  0: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  89 C0 \\
  66 41 0F 38 01 04 07
@dis:
     0:	89 c0                                        	mov    %eax,%eax
     2:	66 41 0f 38 01 04 07                         	phaddw (%r15,%rax,1),%xmm0
@rdfa_output:
  return code: 0
----------------------------------------------------------------------
@hex:
  # REX prefix can't go before legacy prefix
  89 C0
  41 66 0F 38 01 04 07
@dis:
     0:	89 c0                                        	mov    %eax,%eax
     2:	41                                           	rex.B
     3:	66 0f 38 01 04 07                            	phaddw (%rdi,%rax,1),%xmm0
@rdfa_output:
  2: [0] unrecognized instruction
  return code: 1
----------------------------------------------------------------------
@hex:
  89 C0 \\
  F2 41 0F 58 04 07
@dis:
     0:	89 c0                                        	mov    %eax,%eax
     2:	f2 41 0f 58 04 07                            	addsd  (%r15,%rax,1),%xmm0
@rdfa_output:
  return code: 0
----------------------------------------------------------------------
@hex:
  # REX prefix can't go begore legacy prefix
  89 C0
  41 F2 0F 58 04 07
@dis:
     0:	89 c0                                        	mov    %eax,%eax
     2:	41                                           	rex.B
     3:	f2 0f 58 04 07                               	addsd  (%rdi,%rax,1),%xmm0
@rdfa_output:
  2: [0] unrecognized instruction
  return code: 1

# -*- python -*-
# Copyright (c) 2012 The Native Client Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

Import('env')

libs = []
if not env.Bit('tests_use_irt'):
  if env.Bit('nacl_glibc'):
    # libnacl_random_private depends on functions in irt_blockhook.c,
    # which we don't have when building against nacl-glibc.
    Return()
  libs += ['libnacl_random_private']

nexe = env.ComponentProgram(
    env.ProgramNameForNmf('random_test'), 'random_test.c',
    EXTRA_LIBS=libs + ['${NONIRT_LIBS}', '${TESTRUNNER_LIBS}', 'nacl'])

node = env.CommandSelLdrTestNacl('random_test.out', nexe,
                                 sel_ldr_flags=['-E', 'OUTSIDE_BROWSER=1'])
env.AddNodeToTestSuite(node, ['small_tests'], 'run_random_test')
